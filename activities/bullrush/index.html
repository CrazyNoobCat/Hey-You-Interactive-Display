<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Bullrush | Hey You, Interact With Me!</title>

    <style>
      :root {
	  --bullrush-background: url("waves-monochrome.svg");
      }
    </style>
    
    <link rel="icon" href="logo/heyyou-fav.ico" sizes="any" />    
    <link rel="stylesheet" type="text/css" href="bullrush.css" /> 

    <!-- Cast Debug Logger -->
    <!--<script type="text/javascript" src="//www.gstatic.com/cast/sdk/libs/devtools/debug_layer/caf_receiver_logger.js"></script>-->
    <script type="text/javascript" src="//www.gstatic.com/cast/sdk/libs/caf_receiver/v3/cast_receiver_framework.js"></script>    

    <script type="text/javascript" src="/scripts/jquery-1.11.2.min.js"></script>
    <script type="text/javascript" src="socketCreation.js"></script>

    <script type="text/javascript" src="/scripts/display-utils.js"></script>
    <script type="text/javascript" src="/scripts/bullrush-utils.js"></script>
    <script type="text/javascript" src="/scripts/bullrush-display.js"></script>
	
    <script>
      function socketLoaded(anyListener){
          socket.onAny(anyListener); // Turns on the any listener
	  
          socket.emit("displayLoaded");   

	  var QRDim = 260;
	  var displayHost = self.location.host;
	  var roomID    = getCookie('roomID');
	  var roomName  = getCookie('roomName');

	  displayRoomQRCode(displayHost,roomID,QRDim,"join-qrcode");
	  displayRoomURL(displayHost,roomName,"join-room-url");
      }            
      
      function emitPlayerMarker(socketId, playerColor, playerType, playerLabel){
          console.log("Notifying Player of their allocated marker. Sending to socket-id '" + socketId +"': " + playerLabel + ", colour=" + playerColor + ", label=" + playerLabel);
          socket.emit('displayEmit', socketId, 'playerMarker', playerColor, playerType, playerLabel);
      }

      function emitInfoTopline(socketId,message){
          console.log("Notifying Player of info topline message. Sending to socket-id: " + socketId + "message=" + message);
          socket.emit('displayEmit', socketId, 'infoToplineMessage', message);
      }
      
      function emitRunnerHasBeenTagged(socketId){
          console.log("Notifying Runner that they have been tagged. Sending to socket-id: " + socketId);
          socket.emit('displayEmit', socketId, 'playerTaggerContact','gotcha');
      }

      function emitTaggerHasCaughtRunner(socketId){
	  console.log("Notifying Tagger that they have caught a Runner. Sending to socket-id: " + socketId);
          socket.emit('displayEmit', socketId, 'playerTaggerContact','collide');
      }

      function emitWinner(socketId){
          console.log("Notifying Runner that they have won. Sending to socket-id: " + socketId);
          socket.emit('displayEmit', socketId, 'endOfGame', "Last runner standing.<br/>Congratulations you win!", "winner");
      }

      function emitYouWereCaught(socketId){
          console.log("Notifying a player than was originally a Runner that they have lost. Sending to socket-id: " + socketId);
          socket.emit('displayEmit', socketId, 'endOfGame', "You started life as a Runner, but were caught by a tagger.");
      }
      
      function emitEveryoneCaptured(socketId){
          console.log("Notifying Tagger that everyone is now caught. Sending to socket-id: " + socketId);
          socket.emit('displayEmit', socketId, 'endOfGame', "As a Tagger, <i>Mission Accomplished!</i> Everyone has been caught.");
      }
      
      function reset(){
          console.log("Display Reset Sent");
          socket.emit('displayReset');                
      }

      setupConnection("display");  

    </script>
    
  </head>
  
  <body>
    <div class="fullscreen-canvas-container">
      <canvas id="gameCanvas" class="canvas-bg-waves-monochrome">
	Your browser does not support the HTML5 canvas tag.
      </canvas>    
    </div>
    <div id="infobox" class="infobox"></div>
    
    <div id="join-container" class="qrcode-center" style="width: 260px; display: block; z-index: 3; background-color: #faaa33d0; padding: 6px; font-family: monospace;">
      <div id="join-qrcode-div" style="position: relative; height: 260px;">
	<div id="join-qrcode"></div>
      </div>
      <h3  id="join-room-url"   style="position: relative;"></h3>
    </div>

    
    <footer>
      <script src="/scripts/receiver.js"></script>
    </footer>
  </body>
</html>
