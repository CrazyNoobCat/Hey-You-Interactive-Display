<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Bullrush | Hey You, Interact With Me!</title>

    <link rel="icon" href="logo/heyyou-fav.ico" sizes="any" />    
    <link rel="stylesheet" type="text/css" href="bullrush.css" /> 

    <!-- Cast Debug Logger -->
    <!--<script src="//www.gstatic.com/cast/sdk/libs/devtools/debug_layer/caf_receiver_logger.js"></script>-->
    <script src="//www.gstatic.com/cast/sdk/libs/caf_receiver/v3/cast_receiver_framework.js"></script>    

    <script src="socketCreation.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

    <script src="/scripts/bullrush-utils.js" type='text/javascript'></script>
    <script src="/scripts/main.js" type='text/javascript'></script>
	
    <script>
      function socketLoaded(anyListener){
          socket.onAny(anyListener); // Turns on the any listener
	  
          socket.emit("displayLoaded");   
	  
          var nric = self.location.host;
          var url = 'https://api.qrserver.com/v1/create-qr-code/?data=' + nric + '/join/' + getCookie('roomID') + '&size=250x250';
          var $img = $('<img>').attr('src',url);
          $('#barcode').html($img)             
      }            
      
      function emitPlayerMarker(id, playerColor, playerType, playerLabel){
          console.log("Notifying Player of their allocated marker. Sending to socket-id '" + id +"': " + playerLabel + ", colour=" + playerColor + ", label=" + playerLabel);
          socket.emit('displayEmit', id, 'playerMarker', playerColor, playerType, playerLabel);
      }
      
      function emitRunnerHasBeenTagged(id){
          console.log("Notifying Runner that they have been tagged. Sending to socket-id: " + id);
          socket.emit('displayEmit', id, 'playerTaggerContact');
      }

      function emitTaggerHasCaughtRunner(id){
	  console.log("Notifying Tagger that they have caught a Runner. Sending to socket-id: " + id);
          socket.emit('displayEmit', id, 'playerTaggerContact');	  
      }

      function emitWinner(id){
          console.log("Notifying Runner that they have won. Sending to socket-id: " + id);
          socket.emit('displayEmit', id, 'endOfGame', "Last runner standing.<br/>Congratulations you win!");
      }

      function emitYouWereCaught(id){
          console.log("Notifying a player than was originally a RUnner that they have lost. Sending to socket-id: " + id);
          socket.emit('displayEmit', id, 'endOfGame', "You started life as a Runner, but were caught by a tagger.");
      }
      
      function emitEveryoneCaptured(id){
          console.log("Notifying Tagger that everyone is now caught. Sending to socket-id: " + id);
          socket.emit('displayEmit', id, 'endOfGame', "As a Tagger, <i>Mission Accomplished!</i> Everyone has been caught.");
      }
      
      function reset(){
          console.log("Display Reset Sent");
          socket.emit('displayReset');                
      }

      setupConnection("display");  

    </script>
    
  </head>
  
  <body>
    <div class="fullscreen-canvas-container">
      <canvas id="gameCanvas" class="canvas-bg-waves-monochrome">
	Your browser does not support the HTML5 canvas tag.
      </canvas>    
    </div>
    <div id="infobox" class="infobox"></div>
    <div id="barcode" class="barcode-center"></div>
    
    <footer>
      <script src="receiver.js"></script>
    </footer>
  </body>
</html>
