<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Gamedev Canvas Workshop</title>
    <style>
        .button {
            position: relative;
            margin: auto;
            margin-top: 5px;
            padding: 10px;
            text-align: center;
            width: 400px;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            color: black;
            font-size: 50px;
            text-decoration: none;
            background-color: burlywood;
        }
    </style>

    
</head>
<body>
    <h1 id="heading">Please connect and select an activity</h1>
    
    <img id='barcode' 
            src="https://api.qrserver.com/v1/create-qr-code/?data=HelloWorld&amp;size=100x100" 
            alt="" 
            width="100" 
            height="100" />

            
    <h3 id='website'>Website: </h3>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script type="text/javascript">

            var nric = self.location.host;
            console.log(nric);
            var url = 'https://api.qrserver.com/v1/create-qr-code/?data=' + nric + '&amp;size=100x100';
            $('#barcode').attr('src', url);
    </script>
    
    <script src="/socket.io/socket.io.js"></script>
    <script>
        var socket;

        // Get the visitor identifier when you need it.
        function getVisitorID(){
            const fpPromise = import('https://openfpcdn.io/fingerprintjs/v3')
            .then(FingerprintJS => FingerprintJS.load());
            
            fpPromise
            .then(fp => fp.get())
            .then(result => setupSocket(result.visitorId))    
        }

        function setupSocket(visitorID){
            console.log(visitorID);
            var socketType = 'display';
            var url = window.location.host;
            socket = io(url , {
                query: {
                    "data" : socketType,
                    "clientID" : visitorID
                }
            });

            socket.on('reload', () => {
                window.location.href = '/activity';
            }); 
        }    
        
        getVisitorID();
    </script>
    </body>
</html>